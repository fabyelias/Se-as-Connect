<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Se√±as Connect - Comunicaci√≥n Inclusiva</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/accessibility.css">
    <!-- MediaPipe -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/hands.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3.1640029074/camera_utils.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils@0.3.1620248257/drawing_utils.min.js" crossorigin="anonymous"></script>
    <!-- TensorFlow.js para ML -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
</head>
<body>
    <!-- Pantalla de carga inicial -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h1>Se√±as Connect</h1>
            <p id="loading-status">Cargando componentes...</p>
        </div>
    </div>

    <!-- Banner para desbloquear audio en m√≥viles -->
    <div id="audio-unlock-banner" class="audio-unlock-banner hidden">
        <div class="audio-unlock-content">
            <span>üîá Audio desactivado</span>
            <button id="btn-unlock-audio" class="btn btn-warning">
                üîä Tocar para activar audio
            </button>
        </div>
    </div>

    <!-- Contenedor principal -->
    <div id="app" class="app-container hidden">
        <!-- Header con controles de accesibilidad -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">ü§ù</span>
                <h1>Se√±as Connect</h1>
            </div>
            <div class="accessibility-controls">
                <button id="btn-contrast" class="btn-icon" title="Alto contraste" aria-label="Cambiar contraste">
                    <span class="icon">‚óê</span>
                </button>
                <button id="btn-font-size" class="btn-icon" title="Aumentar texto" aria-label="Aumentar tama√±o de texto">
                    <span class="icon">A+</span>
                </button>
                <button id="btn-fullscreen" class="btn-icon" title="Pantalla completa" aria-label="Pantalla completa">
                    <span class="icon">‚õ∂</span>
                </button>
            </div>
        </header>

        <!-- √Årea principal dividida en dos modos -->
        <main class="main-content">
            <!-- Panel izquierdo: Modo Se√±as (Persona sordomuda comunica) -->
            <section class="panel panel-signs" id="panel-signs">
                <div class="panel-header">
                    <h2>üëê Lengua de Se√±as ‚Üí Texto/Audio</h2>
                    <p class="panel-subtitle">La persona sordomuda hace se√±as frente a la c√°mara</p>
                </div>

                <div class="camera-container">
                    <video id="video-signs" class="camera-video" autoplay playsinline muted webkit-playsinline></video>
                    <canvas id="canvas-signs" class="camera-canvas"></canvas>

                    <!-- Indicadores de estado -->
                    <div class="status-indicators">
                        <div id="indicator-hands" class="indicator inactive">
                            <span class="indicator-dot"></span>
                            <span class="indicator-text">Manos detectadas</span>
                        </div>
                        <div id="indicator-gesture" class="indicator inactive">
                            <span class="indicator-dot"></span>
                            <span class="indicator-text">Gesto reconocido</span>
                        </div>
                    </div>
                </div>

                <!-- Texto reconocido -->
                <div class="output-container">
                    <div class="output-label">Mensaje detectado:</div>
                    <div id="output-text" class="output-text" aria-live="polite">
                        Esperando se√±as...
                    </div>
                    <div class="output-actions">
                        <button id="btn-speak" class="btn btn-primary btn-large" disabled>
                            üîä Reproducir Audio
                        </button>
                        <button id="btn-clear-signs" class="btn btn-secondary">
                            üóëÔ∏è Limpiar
                        </button>
                    </div>
                </div>

                <!-- Control de c√°mara -->
                <div class="camera-controls">
                    <button id="btn-start-camera" class="btn btn-success btn-xlarge">
                        üì∑ Iniciar C√°mara
                    </button>
                    <button id="btn-stop-camera" class="btn btn-danger btn-xlarge hidden">
                        ‚èπÔ∏è Detener C√°mara
                    </button>
                    <select id="select-camera" class="select-camera" aria-label="Seleccionar c√°mara">
                        <option value="">Seleccionar c√°mara...</option>
                    </select>
                </div>
            </section>

            <!-- Divisor central -->
            <div class="panel-divider">
                <div class="divider-icon">‚áÑ</div>
            </div>

            <!-- Panel derecho: Modo Voz (Oyente comunica) -->
            <section class="panel panel-voice" id="panel-voice">
                <div class="panel-header">
                    <h2>üé§ Voz ‚Üí Texto</h2>
                    <p class="panel-subtitle">El oyente habla y el texto aparece en pantalla</p>
                </div>

                <!-- √Årea de texto grande para la persona sordomuda -->
                <div class="voice-output-container">
                    <div id="voice-text" class="voice-text" aria-live="polite">
                        Presion√° el bot√≥n y habl√°...
                    </div>
                </div>

                <!-- Indicador de grabaci√≥n -->
                <div id="recording-indicator" class="recording-indicator hidden">
                    <div class="recording-pulse"></div>
                    <span>Escuchando...</span>
                </div>

                <!-- Controles de voz -->
                <div class="voice-controls">
                    <button id="btn-start-voice" class="btn btn-success btn-xlarge">
                        üé§ Comenzar a Escuchar
                    </button>
                    <button id="btn-stop-voice" class="btn btn-danger btn-xlarge hidden">
                        ‚èπÔ∏è Dejar de Escuchar
                    </button>
                    <button id="btn-clear-voice" class="btn btn-secondary">
                        üóëÔ∏è Limpiar Texto
                    </button>
                </div>

                <!-- Historial de mensajes -->
                <div class="message-history">
                    <h3>Historial de conversaci√≥n:</h3>
                    <div id="history-container" class="history-container">
                        <!-- Los mensajes se agregan din√°micamente -->
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer con informaci√≥n -->
        <footer class="footer">
            <p>Se√±as Connect v1.0 - Comunicaci√≥n Inclusiva para Todos</p>
            <p class="footer-note">Compatible con computadoras y dispositivos m√≥viles</p>
        </footer>
    </div>

    <!-- Modal de instrucciones -->
    <div id="modal-instructions" class="modal">
        <div class="modal-content">
            <h2>Bienvenido a Se√±as Connect</h2>
            <div class="instructions">
                <div class="instruction-step">
                    <span class="step-number">1</span>
                    <div class="step-content">
                        <h3>Para personas sordomudas</h3>
                        <p>Hac√© se√±as frente a la c√°mara. La app convertir√° tus se√±as en texto y audio.</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <span class="step-number">2</span>
                    <div class="step-content">
                        <h3>Para personas oyentes</h3>
                        <p>Presion√° el bot√≥n del micr√≥fono y habl√°. Tu mensaje aparecer√° en texto grande.</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <span class="step-number">3</span>
                    <div class="step-content">
                        <h3>Accesibilidad</h3>
                        <p>Us√° los botones de la esquina superior derecha para ajustar contraste y tama√±o de texto.</p>
                    </div>
                </div>
            </div>
            <button id="btn-close-modal" class="btn btn-primary btn-large">
                Entendido, ¬°Comenzar!
            </button>
        </div>
    </div>

    <!-- Scripts de la aplicaci√≥n -->
    <script src="js/config.js"></script>
    <script src="js/sign-dictionary.js"></script>
    <script src="js/hand-detector.js"></script>
    <script src="js/sign-recognizer.js"></script>
    <script src="js/speech-services.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
